<!DOCTYPE html>
<html>
<head>
  
</head>
<body>
    <div class="headContainer">
        <div class="titleContainer">
            <h1 class="titleContext">TODO it!</h1>
        </div>
        <div class="btnContainer">
            <input class="btnInsert" type="text" style="border:none;"/>
            <div class="btnContext">
                <div class="btnContextText">
                +
                </div>
            </div>
        </div>
    </div>
    <div class="contentsContainer">
        <ul class="ContentsListContainer">
        </ul>
    </div>
    <script>

        const output = localStorage.getItem("list");
        let loadingArr = JSON.parse(output);
        const registerBtn = document.querySelector('.btnContext');
        const totalList = document.querySelector('.ContentsListContainer')
        let countNumber=0;

        console.log("check"+loadingArr);
        if(loadingArr===null) loadingArr=[];
        if(localStorage.getItem("list")!==null) //비어있지 않으면 그립니다.
        {
            

            for (let i in loadingArr)
            {
                const Inserttext = document.createTextNode(loadingArr[i]);
                const removeBtn = document.createTextNode('삭제');
                const removeBtnDiv=document.createElement('div');
                const newList = document.createElement('li');
                const liContextDiv = document.createElement('div');
                const chkBox = document.createElement('input');
                chkBox.id="check"+countNumber;
                chkBox.type="checkbox";
                chkBox.style.cssText = 'font-size: 25px;  width:30px; height:30px; position:absoulte; margin-left: -25px; display:none';
                const chkLabel = document.createElement('label');
                chkLabel.for="check"+countNumber;
                chkLabel.style.cssText='display: inline-block; background-size: 30px; width:30px; float: left; height:30px; background-image:url("./Icon/icons8-unchecked-checkbox-100.png");' ;
             
                


                liContextDiv.appendChild(Inserttext);
                removeBtnDiv.appendChild(removeBtn);//삭제
                newList.appendChild(chkBox);
                newList.appendChild(chkLabel);
                newList.appendChild(liContextDiv);
                newList.appendChild(removeBtnDiv)

                totalList.appendChild(newList);
                liContextDiv.className="liContextDiv";
                removeBtnDiv.className="removeBtnDiv";
                chkBox.className="checkDiv";
                chkLabel.className="checkDiv2";
                liContextDiv.id=countNumber++;


            }
        }
        

       
       //문제: 길이에 따라서 조정 필요함 순서가 보장된다는 전제하에 마지막 인덱스 값을 넣어준다.->순서보장안됨// 특정 인덱스에 최대 값을 저장한다. => value에 배열로 저장하면 된다.

        registerBtn.addEventListener('click',addList);
        function addList(){

     
            const InsertValue = document.querySelector('.btnInsert').value;
            const Inserttext = document.createTextNode(InsertValue);

            const removeBtn = document.createTextNode('삭제');
            const removeBtnDiv=document.createElement('div');
            const newList = document.createElement('li');
            const liContextDiv = document.createElement('div');
            const chkBox = document.createElement('input');
            chkBox.id="check"+countNumber;
            chkBox.type="checkbox";
            chkBox.style.cssText = 'content:✔; font-size: 25px; display: none; width:30px; height:30px; position:relative;';
            const chkLabel = document.createElement('label');
            chkLabel.style.cssText='display: inline-block; background-size: 30px; width:30px; float: left; height:30px; background-image:url("./Icon/icons8-unchecked-checkbox-100.png");' ;
             
            chkLabel.for="check"+countNumber;
            
            liContextDiv.appendChild(Inserttext);
            removeBtnDiv.appendChild(removeBtn);//삭제
            newList.appendChild(chkBox);
            newList.appendChild(chkLabel);
            newList.appendChild(liContextDiv);
            newList.appendChild(removeBtnDiv)

            totalList.appendChild(newList);

            liContextDiv.className="liContextDiv";
            removeBtnDiv.className="removeBtnDiv";
            chkBox.className="checkDiv";
            chkLabel.className="checkDiv2";
            liContextDiv.id=countNumber++;

            loadingArr.push(InsertValue);
            localStorage.setItem("list",JSON.stringify(loadingArr));
 



        }
        
        totalList.addEventListener('click',removeList)
        
        function removeList(){
            const bob=event.target.parentNode;
            const ghostbob= bob.parentNode;
            //const deletsNode =event.target.previousSibling.childNodes[0].data; //노드의 텍스트 내용
          
     
            
            if(event.target.className=='removeBtnDiv')
                {                 
                    const deleteIndex=event.target.previousSibling.id;
                    loadingArr.splice(deleteIndex,1);                         
                    localStorage.setItem("list",JSON.stringify(loadingArr));
                    //console.log(loadingArr);
                    ghostbob.removeChild(bob);
                    
                
                }
            else if(event.target.className=='liContextDiv')
                {
                    let labelDiv = event.target.previousSibling;
                    
                    if(event.target.style.textDecoration=="line-through")
                    {   event.target.style.textDecoration="none";
                        labelDiv.style.cssText='display: inline-block; background-size: 30px; width:30px; float: left; height:30px; background-image:url("./Icon/icons8-unchecked-checkbox-100.png");' ;
                    }
                    else
                    {   event.target.style.textDecoration="line-through";
                        labelDiv.style.cssText='display: inline-block; background-size: 30px; width:30px; float: left; height:30px; background-image:url("./Icon/icons8-tick-box-100.png");' ;
                    }
                }
            else if(event.target.className=='checkDiv2')
            {   let textDiv = event.target.nextSibling;
                console.log("ininin");
                console.log(event.target.previousSibling);
                if(textDiv.style.textDecoration=="none") //언체크
                {   console.log("1");
                    event.target.style.cssText='display: inline-block; background-size: 30px; width:30px; float: left; height:30px; background-image:url("./Icon/icons8-tick-box-100.png");' ;
                    textDiv.style.textDecoration="line-through";
                }
                else{console.log("2");
                    event.target.style.cssText='display: inline-block; background-size: 30px; width:30px; float: left; height:30px; background-image:url("./Icon/icons8-unchecked-checkbox-100.png");' ;
                    textDiv.style.textDecoration="none";
                }
            }
            
       

        }    
        
    </script>
</body>
<style>
    .headContainer{
        width: 100%;
        height: 150px;
        background-color:rgb(255, 255, 255);
       
    }
    .titleContainer{
        margin: auto;
        width: 300px;
        height: 100px;
       
        display: flex;
    }
    .titleContext{
        text-align: center;
        width: 80%;
        margin: auto;
        font-size: 50px;
        border-radius: 5%;
        box-shadow: 5px 5px 5px 5px gray;
      
    }
    .btnContainer{
        height: 50px;
        width: 80%;
        margin-left: 13%;
        
    }
    .btnInsert{
        width: 70%;
        height: 45px;
        margin-left: 10%;
        margin-top: 0.1%;
        float: left;
        box-shadow: 5px 5px 5px 5px gray;
    }
    .btnContext{
        width: 5%;
        height: 100%;
        background-color: rgb(17, 47, 114);
        border-radius:0% 18% 18% 0%;
        display: inline-block;
        position: relative;
        box-shadow: 5px 5px 5px 5px gray;
       
    }
    .btnContextText{
     
        position: absolute;
        top: 45%;
        margin-left: 32%;
        transform: translateY(-50%);
        font-size: 35px;
        font-weight: 700;
        color: white;
        
        
        
    }
    .contentsContainer{
        width: 70%;
        margin: auto;
    }
    .ContentsListContainer{
        width: 90%;
        margin-left: 5%;
        box-shadow: 5px 5px 5px 5px gray;
        border-radius: 30px;
        list-style: none;
    }
    .aa{
        width: 50px;
        height: 50px;
        background-color: chocolate;
    }
 
</style>
</html>